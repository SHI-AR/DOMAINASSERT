var avatarModalContent=document.getElementById("edit-avatar-modal");if(avatarModalContent){var avatarModal=new MG_Modal({content:avatarModalContent,className:"avatarContainer",closeDocument:false})}var coverModalContent=document.getElementById("edit-coverImage-modal");if(coverModalContent){var coverImageModal=new MG_Modal({content:coverModalContent,className:"coverContainer",closeDocument:false})}function recalculateModal(a){if($j("#edit-coverImage-modal")[0]||$j("#edit-avatar-modal")[0]){if($j("#edit-coverImage-modal").is(":visible")){$j("#edit-coverImage-modal").css({top:0,left:(($j(document).width()-$j("#edit-coverImage-modal").width())/2)+"px"})}if($j("#edit-avatar-modal").is(":visible")){$j("#edit-avatar-modal").css({top:0,left:(($j(document).width()-$j("#edit-avatar-modal").width())/2)+"px"})}}}function checkIfFileExistsAvt(){valid_extensions=/(\.jpg|\.jpeg|\.gif|\.png)$/i;if($j("#avtrUploadFile").val()!=""){if(valid_extensions.test($j("#avtrUploadFile").val())){$j("#btnSubmitAvatarImage").show();$j(".backContainer").show();$j("#buttonUpAvt").hide();$j("#avatarSizeText").hide();$j(".avatar-modal").addClass("smaller")}else{alert("Invalid File format. Only .jpg, .jpeg, .gif, .png are supported.")}}else{$j("#btnSubmitAvatarImage").hide()}}function processAvatarPreviewJson(a){if(a.success=="PASS"){$j(".avatar-modal").removeClass("smaller");$j(".avatar-modal").addClass("cropping");$j(".avatar-modal #loadingDiv").hide();$j(".uploaderImage").show();$j("#cropping-form-container").show();$j("#targetAvtImage").attr("src",a.imagePath+"?cache="+Math.random());$j("#ratio").val(a.ratio);$j("#path").val(a.tempPath);callCropper();$j(".uploaderImage").bind("mousewheel DOMMouseScroll",function(b){b.preventDefault()})}else{if(a.success=="ERROR"){$j("#loadingDiv").hide();$j("#cropping-form-container").hide();$j("#error_msg_imageType").show();$j(".backContainer").hide();$j("#avatarMessageImgType").html(a.message)}else{}}}function callCropper(){$j("#targetAvtImage").Jcrop({onChange:a,onSelect:a,minSize:[200,200],setSelect:[200,200,0,0],bgOpacity:0.3,allowSelect:false,aspectRatio:1});function a(b){$j("#x").val(b.x);$j("#y").val(b.y);$j("#w").val(b.w);$j("#h").val(b.h)}}function checkIfFileExists(){valid_extensions2=/(\.jpg|\.jpeg|\.gif|\.png)$/i;if($j("#coverUploadFile").val()!=""){if(valid_extensions2.test($j("#coverUploadFile").val())){$j("#btnSubmitCoverImage").show();$j(".backContainer").show();$j("#uploadCoverContainer").hide();$j("#selectFromLibrary").hide();$j("#orLabel").hide();$j("#avatarSizeText").hide();$j(".cover-modal").addClass("smaller")}else{alert("Invalid File format. Only .jpg, .jpeg, .gif, .png are supported.")}}else{$j("#btnSubmitCoverImage").hide()}}function processCoverPreviewJson(a){if($j(".coverContainer").is(":visible")){if(a.success=="PASS"){$j(".cover-modal").addClass("cropping");$j(".cover-modal #loadingDiv").hide();$j(".coverUploaderImage").show();$j(".cover-modal .modal-title").text("Edit Position");$j("#cropping-form-cover-container").show();$j("#covertargetCoverImage").attr("src",a.imagePath+"?cache="+Math.random());$j("#ratio").val(a.ratio);$j("#path").val(a.tempPath);callCoverCropper();$j(".coverUploaderImage").bind("mousewheel DOMMouseScroll",function(b){b.preventDefault()})}else{if(a.success=="ERROR"){$j(".cover-modal #loadingDiv").hide();$j("#cover_error_msg_imageType").show();$j(".backContainer").hide();$j("#coverMessageImgType").html(a.message)}else{}}}}function processCoverSubmitJson(a){if(a.success!="ERROR"){$j("#coverPictureDefault").attr("src",a.coverImage+"?cache="+Math.random())}}function processAvatarSubmitJson(a){if(a.success!="ERROR"){$j("#getAvatar").attr("src",a.avatarImage+"?cache="+Math.random())}}function callCoverCropper(){$j("#covertargetCoverImage").Jcrop({onChange:a,onSelect:a,setSelect:[0,0,800,163],bgOpacity:0.3,allowResize:false,allowSelect:false});function a(b){$j("#x").val(b.x);$j("#y").val(b.y);$j("#w").val(b.w);$j("#h").val(b.h*4.9)}}function attacherGetPreviousPage(c,e,a,b){if(parseInt($j("#attacherCurrentPage").val())>1){var d=parseInt($j("#attacherCurrentPage").val())-1;attacherGetPage(d,c,e,a,b)}else{attacherGetPage(document.getElementById("attacherTotalPages").value,c,e,a,b)}}function attacherGetNextPage(c,e,a,b){if(parseInt($j("#attacherCurrentPage").val())<parseInt($j("#attacherTotalPages").val())){var d=parseInt($j("#attacherCurrentPage").val())+1;attacherGetPage(d,c,e,a,b)}else{attacherGetPage(1,c,e,a,b)}}function attacherGetPage(e,d,f,a,c){var b=d+"?page="+e+"&itemsPerPage="+c+"&type="+f+(a?"&extra="+a:"")+"&selected="+$j("#attachment").val();$j.ajax({type:"POST",url:b,success:function(g){$j(".video_attacher_content").html(g);loadThumbs()}});$j("#attacherCurrentPage").val(e)}function videoAttacherClick(b){if(document.getElementById("video_box_"+document.getElementById("attachment").value)){document.getElementById("video_box_"+document.getElementById("attachment").value).style.border="1px solid #111"}if(document.getElementById("video_box_"+b)){document.getElementById("video_box_"+b).style.border="1px dashed #F98E00";document.getElementById("attachment").value=b;var a=$j("#video_box_"+b).find("img").attr("data-mediumthumb");$j("#selectVideoBtn").click(function(){$j("#featuredImg").attr("src",a)})}}function scEditorInit(d){$j("#content_"+d).sceditor({plugins:"bbcode",toolbar:"bold,italic,underline,link,emoticon,color",style:cssUrl+"pc/sceditor/sceditor.css",emoticonsRoot:cssUrl+"pc/sceditor/",width:"100%",resizeEnabled:false,enablePasteFiltering:true,emoticonsCompat:true});var a=$j("#content_"+d).sceditor("instance"),c=a.val(),b=$j("<div/>").html(c).text();a.val(a.toBBCode(b))}function editStreamPost(c,b,d){var a=$j("#"+b+"_"+c),f=a.find(".feedBlogTile").html(),e=a.find(".feedBlogContent").html();$j("#"+b+"_"+c).addClass("created");$j("#"+b+"_"+c+" .editPost").closest(".actionEdit").hide();if($j("#"+b+"_"+c+" .editPost").hasClass("active")){$j("#tooltip").hide()}$j("#"+b+"_"+c+" .feedBlogTile").hide();$j("#"+b+"_"+c+" .feedBlogContent").hide();$j("#sendEditForm_"+b+"_"+c).closest(".js-editContainer").addClass("contentPadding");if(!$j("#sendEditForm_"+b+"_"+c).hasClass("created")){$j("#"+b+"_"+c+" .feedComments:first").before('<div class="js-editContainer contentPadding"><form id="sendEditForm_'+b+"_"+c+'" class="postTinyMceForm tiny streamEditForm"><input class="tinyTitle" name="title" type="text" value="'+((f==null)?"":f)+'" maxlength="200"><div class="wrapper tinyContainter"><textarea class="content tinymce tinyEditContent" id="content_'+c+'" name="content" style="height:130px;">'+e+'</textarea><input id="editPostButton_'+c+'" type="submit" class="editPostButton streamButtonPost orangeButton buttonBase float-right" value="Edit Post" onclick="submitAjaxEditPost('+c+",'"+b+"',"+d+'); return false;"><button class="cancelEditPost streamButtonPost buttonBase float-right"><span>Cancel</span></button></div></form><div class="feedback-msg errorTiny"><div class="error_2 error">You have to type a message.</div></div></div>');scEditorInit(c)}else{$j("#"+b+"_"+c).find(".postTinyMceForm").toggle();scEditorInit(c)}$j("input.tinyTitle").keydown(function(g){if(g.keyCode==13){g.preventDefault()}});$j("#"+b+"_"+c+" .cancelEditPost").on("click",function(i){var g=$j("#content_"+c).sceditor("instance");var h=$j("#stream_posts_users_"+c).find(".feedBlogContent").html();g.val(h);i.preventDefault();$j("#sendEditForm_"+b+"_"+c).addClass("created");$j("#sendEditForm_"+b+"_"+c).hide();$j("#"+b+"_"+c+" .editPost").closest(".actionEdit").show();$j("#"+b+"_"+c+" .feedBlogTile").show();$j("#"+b+"_"+c+" .feedBlogContent").show();$j("#"+b+"_"+c+" .editPost").closest(".actionEdit").show();$j("#"+b+"_"+c+" .editPost").removeAttr("disabled").removeClass("active");$j("#"+b+"_"+c+" .js-editContainer").removeClass("contentPadding")})}function submitAjaxEditPost(e,d,f){var c=$j("#content_"+e).sceditor("instance").val(),a=$j("<div/>").html(c).text(),b=$j("#sendEditForm_"+d+"_"+e);if(!c){$j("#"+d+"_"+e+" .errorTiny .error_2").fadeToggle();setTimeout(function(){$j("#"+d+"_"+e+" .errorTiny .error_2").fadeToggle()},3000)}else{$j.ajax({type:"POST",dataType:"json",data:{title:b.children("input").val(),content:a},url:"/user/stream_post_edit?id="+f,success:function(g){$j("#"+d+"_"+e+" .feedBlogTile").remove();$j("#"+d+"_"+e+" .js-editContainer").removeClass("contentPadding");$j("#"+d+"_"+e+" .feedBlogContent").before('<h2 class="feedBlogTile">'+g.title+"</h2>");$j("#"+d+"_"+e+" .feedBlogTileOwn").show();$j("#"+d+"_"+e+" .feedBlogContent").html(g.content).show();b.hide().addClass("created");$j("#"+d+"_"+e+" .editPost").closest(".actionEdit").show()}})}}head.ready(document,function(d){var j=$j("#MHP1138-frm1").attr("data-url");var b={url:j,dataType:"json",contentType:"application/json",cache:false,async:true,success:processAvatarPreviewJson};var i=$j("#MHP1138-cropimgFrom").attr("data-url");var g={url:i,dataType:"json",contentType:"application/json",cache:false,async:true,success:processAvatarSubmitJson};$j("body").on("click","#avtrSubmitImage",function(){$frm1=$j("#frm1"),$loadingDiv=$j(".avatar-modal #loadingDiv"),$backContainer=$j(".backContainer");$frm1.submit(function(k){$j(this).ajaxSubmit(b);$frm1.hide();$backContainer.hide();$loadingDiv.show();k.preventDefault()})});$j("body").on("click","#submitAvatarCrop",function(){var e=$j("#cropimgFrom"),k=$j("#loadingDiv");e.submit(function(l){$j(this).ajaxSubmit(g);$j("#avatar-form").hide();k.show();setTimeout(function(){if(typeof avatarModal!=="undefined"){avatarModal.closeModal()}},1000);l.preventDefault()})});$j("body").on("click","#gobackUploadsModalAvt",function(){$j(".backContainer").hide();$j(".avatar-modal").removeClass("smaller");if(typeof avatarModal!=="undefined"){avatarModal.closeModal(function(){avatarModal.openModal()})}$j("#coverID").removeAttr("value");$j("#modalWrapper").addClass("scrollPostion")});$j("body").on("click",".closeAvatar",function(){$j("#targetAvtImage").removeAttr("src");$j(".uploaderImage").hide();$j(".backContainer").hide();$j(".avatar-modal").removeClass("smaller");$j(".avatar-modal").removeClass("cropping");$j("#modalWrapper").addClass("scrollPostion");if(typeof avatarModal!=="undefined"){avatarModal.closeModal()}});var h=$j("#MHP1138-cvfrm1").attr("data-url");var c={url:h,dataType:"json",success:processCoverPreviewJson};var a=$j("#MHP1138-covercropimgFrom").attr("data-url");var f={url:a,dataType:"json",success:processCoverSubmitJson};$j("body").on("click",".cover-modal .xBtn",function(){var e=$j(this).parent("li"),k=e.attr("data-coverId");coverType=e.attr("data-coverType");if(coverType=="site"){siteId=e.attr("data-siteId");yesNoModal.show("Are you sure you want to remove this cover photo?",function(){$j.ajax({url:"/uploading/cover_remove",data:{timestamp:k,siteId:siteId,type:coverType},cache:false,type:"POST",success:function(l){e.remove();$j("#submitCoverID").prop("disabled",true)}})})}else{yesNoModal.show("Are you sure you want to remove this cover photo?",function(){$j.ajax({url:"/uploading/cover_remove",data:{timestamp:k},cache:false,type:"POST",success:function(l){e.remove();$j("#submitCoverID").prop("disabled",true)}})})}});$j("body").on("click","#coverSubmitImage",function(){var m=$j("#coverUploadFile"),l=$j(".coverUploaderImage"),n=$j("#cvfrm1"),e=$j("#selectFromLibrary"),k=$j(".cover-modal #loadingDiv"),o=$j("#orLabel");n.submit(function(p){$j(this).ajaxSubmit(c);n.hide();$j(".backContainer").hide();e.hide();o.hide();$j(".cover-modal").removeClass("smaller");k.show();p.preventDefault()})});$j("body").on("click","#submitCoverCrop",function(){var e=$j("#covercropimgFrom"),k=$j(".cover-modal #loadingDiv");e.submit(function(l){$j(this).ajaxSubmit(f);$j("#avatar-form").hide();$j(".coverUploaderImage").hide();k.show();setTimeout(function(){if(typeof coverImageModal!=="undefined"){coverImageModal.closeModal()}},1000);l.preventDefault()})});$j("body").on("click","#btnSelectFromLibrary",function(m){var k=$j("#avatar-form"),l=$j("#defaultCoverContainer");$defaultCoverContent=$j(".defaultCoverImages");$defaultCoverContent.slimScroll({height:"500px",color:"#F39000",size:"7px",alwaysVisible:true,railVisible:true,railOpacity:1,railColor:"#222",distance:0,opacity:1,railClass:"track3",barClass:"handle3"});$defaultCoverContent.bind("mousewheel DOMMouseScroll",function(n){n.preventDefault()});$j("#modalWrapper .modal-title").text("Select from Pornhub library");k.hide();l.show();$j("#modalWrapper").addClass("scrollPostion");m.preventDefault()});$j("body").on("click",".clickSelectedCover",function(l){var k=$j(this).attr("data-coverId");$j("#coverID").val(k);if($j(this).hasClass("coverSelected")){$j(this).removeClass("coverSelected")}else{$j(".clickSelectedCover").removeClass("coverSelected");$j(this).addClass("coverSelected")}$j("#submitCoverID").prop("disabled",!$j('li[data-coverId="'+k+'"]').hasClass("coverSelected"))});$j("body").on("click","#submitCoverID",function(){setTimeout(function(){if(typeof coverImageModal!=="undefined"){coverImageModal.closeModal()}location.reload()},1000)});$j("body").on("click","#gobackUploadsModal",function(){$j(".backContainer").hide();$j(".cover-modal").removeClass("smaller");if(typeof coverImageModal!=="undefined"){coverImageModal.closeModal(function(){coverImageModal.openModal()})}});$j("body").on("click",".closeCover",function(){$j(".uploaderImage").hide();$j(".backContainer").hide();$j(".cover-modal").removeClass("smaller");$j(".cover-modal").removeClass("cropping");if(typeof coverImageModal!=="undefined"){coverImageModal.closeModal()}return false});$j("div#coverPicture button, div#avatarPicture button").on("click",function(){$j("div#modalWrapper").addClass("scrollPostion")});$j(window).resize(recalculateModal);$j(".coverImageModalTrigger").on("click",function(e){e.preventDefault();if(typeof coverImageModal!=="undefined"){coverImageModal.openModal(function(){$j(".coverContainer").draggable({cursor:"move",handle:"div.modal-title, #defaultCoverContainer"})})}});$j(".avatarModalTrigger").on("click",function(e){e.preventDefault();if(typeof avatarModal!=="undefined"){avatarModal.openModal(function(){$j(".avatarConatiner").draggable({cursor:"move",handle:"div.modal-title, #defaultCoverContainer"})})}})});